### トークンの指定
@token = Bearer eyJ0eXAiOiJKV1QiLCJub25jZSI6IkY3UHBtM1NvbW9JZUlCZ0IxZl9QYW1XM2p6X1ZuSWhvMEY4TXdCRjA5MUEiLCJhbGciOiJSUzI1NiIsIng1dCI6IjJaUXBKM1VwYmpBWVhZR2FYRUpsOGxWMFRPSSIsImtpZCI6IjJaUXBKM1VwYmpBWVhZR2FYRUpsOGxWMFRPSSJ9.eyJhdWQiOiIwMDAwMDAwMy0wMDAwLTAwMDAtYzAwMC0wMDAwMDAwMDAwMDAiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC82YzFmNjlhYy0wMjk0LTRlYjMtODcwOS01NzI0YTUwYzRjNTUvIiwiaWF0IjoxNjY0NDM4NjA2LCJuYmYiOjE2NjQ0Mzg2MDYsImV4cCI6MTY2NDQ0MjUzNiwiYWNjdCI6MCwiYWNyIjoiMSIsImFpbyI6IkFUUUF5LzhUQUFBQUJnTmZuSjY1c0hEbFBNa0xzK3BNWWtiRWJ0RnB3TExmVldSR20xbkRpakozb0IxTkdhYzBPUGJzSENRRWp4VVEiLCJhbXIiOlsicHdkIl0sImFwcF9kaXNwbGF5bmFtZSI6IkdyYXBoIEV4cGxvcmVyIiwiYXBwaWQiOiJkZThiYzhiNS1kOWY5LTQ4YjEtYThhZC1iNzQ4ZGE3MjUwNjQiLCJhcHBpZGFjciI6IjAiLCJmYW1pbHlfbmFtZSI6IihJVCkiLCJnaXZlbl9uYW1lIjoiQnJ1bm8iLCJpZHR5cCI6InVzZXIiLCJpcGFkZHIiOiIxMjUuMTAyLjIyMS4yMDkiLCJuYW1lIjoiQnJ1bm8gKElUKSIsIm9pZCI6ImFlYWMwMGU3LWM1MjAtNDNjMi04OTViLTViYzExNzEyMGE4NiIsInBsYXRmIjoiMyIsInB1aWQiOiIxMDAzMjAwMUM5NDBBN0U0IiwicmgiOiIwLkFWVUFyR2tmYkpRQ3MwNkhDVmNrcFF4TVZRTUFBQUFBQUFBQXdBQUFBQUFBQUFDSUFBZy4iLCJzY3AiOiJDYWxlbmRhcnMuUmVhZFdyaXRlIENoYXQuUmVhZCBDaGF0LlJlYWRCYXNpYyBDb250YWN0cy5SZWFkV3JpdGUgRGV2aWNlTWFuYWdlbWVudFJCQUMuUmVhZC5BbGwgRGV2aWNlTWFuYWdlbWVudFNlcnZpY2VDb25maWcuUmVhZC5BbGwgRWR1QXNzaWdubWVudHMuUmVhZCBFZHVBc3NpZ25tZW50cy5SZWFkQmFzaWMgRWR1QXNzaWdubWVudHMuUmVhZFdyaXRlIEVkdUFzc2lnbm1lbnRzLlJlYWRXcml0ZUJhc2ljIEVkdVJvc3Rlci5SZWFkQmFzaWMgRmlsZXMuUmVhZFdyaXRlLkFsbCBHcm91cC5SZWFkV3JpdGUuQWxsIElkZW50aXR5Umlza0V2ZW50LlJlYWQuQWxsIE1haWwuUmVhZCBNYWlsLlJlYWRXcml0ZSBNYWlsYm94U2V0dGluZ3MuUmVhZFdyaXRlIE5vdGVzLlJlYWRXcml0ZS5BbGwgb3BlbmlkIFBlb3BsZS5SZWFkIFBsYWNlLlJlYWQgUHJlc2VuY2UuUmVhZCBQcmVzZW5jZS5SZWFkLkFsbCBQcmludGVyU2hhcmUuUmVhZEJhc2ljLkFsbCBQcmludEpvYi5DcmVhdGUgUHJpbnRKb2IuUmVhZEJhc2ljIHByb2ZpbGUgUmVwb3J0cy5SZWFkLkFsbCBTaXRlcy5SZWFkV3JpdGUuQWxsIFRhc2tzLlJlYWRXcml0ZSBVc2VyLlJlYWQgVXNlci5SZWFkQmFzaWMuQWxsIFVzZXIuUmVhZFdyaXRlIFVzZXIuUmVhZFdyaXRlLkFsbCBlbWFpbCIsInNpZ25pbl9zdGF0ZSI6WyJrbXNpIl0sInN1YiI6Ik9sUkxiMmpHZzZGZ2hJUnNPVXhGekNGTnBMNmVxNnZlV2VSODNDRjg3cEEiLCJ0ZW5hbnRfcmVnaW9uX3Njb3BlIjoiQVMiLCJ0aWQiOiI2YzFmNjlhYy0wMjk0LTRlYjMtODcwOS01NzI0YTUwYzRjNTUiLCJ1bmlxdWVfbmFtZSI6ImFkbWluQE0zNjVFRFU1NjE5Mzkub25taWNyb3NvZnQuY29tIiwidXBuIjoiYWRtaW5ATTM2NUVEVTU2MTkzOS5vbm1pY3Jvc29mdC5jb20iLCJ1dGkiOiJWM2VzQ0wxUHQwdXMzQTltNTVFYkFBIiwidmVyIjoiMS4wIiwid2lkcyI6WyI2MmU5MDM5NC02OWY1LTQyMzctOTE5MC0wMTIxNzcxNDVlMTAiLCJiNzlmYmY0ZC0zZWY5LTQ2ODktODE0My03NmIxOTRlODU1MDkiXSwieG1zX3N0Ijp7InN1YiI6IldNbzhnVklrMndQd1ZlMjd0MmZlQWpRVkFJbjN2ZnJLOGZJNzI2QVJvY28ifSwieG1zX3RjZHQiOjE2NDE0NzM2NTF9.Nu0W4XFmF9zb_XkbZn6SnUr-hkpOv2__DoGejrZ8V4FmVNXQm0zAKqLXG6nA6_nNLMC2LkTEw0ca0NhL4SICzrz8oKNIn_Mat_qZg86tZSHVia4q92IKgEhkG3uKsLInQRa7-eXp4r_TLyZFuCF898Ghe8uDblJ8UCpMPg-2tfAUDWJPLwCLUU1KTTJpY1kOfMd0-ATPU9jIfcwt-7a4yWIlyiyW4QrJYVfsqLX2Ln8RaM3GSTQn_OUUAzqLL1EMYBPPJ4QJ5_VNEjvQg3_bvW8MXciMtESBsGV1y4TCPvt00ohab-1gcIPV1LXD5LafscPRxajMCo13nOsd_5jebw

// Microsoft Teams for Education のクラス一覧を取得
GET https://graph.microsoft.com/v1.0/education/classes
Authorization: {{token}}


### クラス ID の指定
//ここに任意のクラス ID を指定
@class-id = 8d7b4314-68fd-4144-95a2-2783d90dc118

//任意のクラスに割り当て(課題)を下書きの状態で作成
POST https://graph.microsoft.com/v1.0//education/classes/{{class-id}}/assignments
Authorization: {{token}}
Content-Type: application/json

{
    "displayName": "Graph API で作成した課題2",
    "dueDateTime": "2023-01-01T14:59:00Z",
    "instructions": {
        "content": "ハンズオン資料の手順に沿って作業します",
        "contentType": "html"
    },
    "grading": {
        "@odata.type": "#microsoft.graph.educationAssignmentPointsGradeType",
        "maxPoints": 50
    },
    "assignTo": {
        "@odata.type": "#microsoft.graph.educationAssignmentClassRecipient"
    },
    "status": "draft",
    "allowStudentsToAddResourcesToSubmission": "true"
}


### 割り当て ID の指定
//ここに任意の割り当て ID を指定
@assignment-id = 1dd79ecc-4bf3-4570-8c0f-7d85e301d6d1

//割り当て(課題)に添付するためのファイルをアップロードするリソースフォルダを作成
POST https://graph.microsoft.com/v1.0/education/classes/{{class-id}}/assignments/{{assignment-id}}/setUpResourcesFolder
Authorization: {{token}}
Content-Type: application/json

{}


### 割り当てにリンクを添付する

//educationFileResource を作成
POST https://graph.microsoft.com/v1.0/education/classes/{{class-id}}/assignments/{{assignment-id}}/resources
Authorization: {{token}}
Content-type: application/json

{
    "distributeForStudentWork": false,
    "resource": {
        "displayName": "Microsoft Teams オンライン & リモート学習 | Microsoft Education",
        "link": "https://www.microsoft.com/ja-jp/education/products/teams",
        "thumbnailPreviewUrl": null,
        "@odata.type": "#microsoft.graph.educationLinkResource"
    }
}



### リソースフォルダのパスを指定
@resourcesFolderUrl = https://graph.microsoft.com/v1.0/drives/b!aKengelSM0iBQKkgKWInObjlPupbcyZHioQtuvlMHIzGLRIfCr3MRobbRxHwNrrr/items/01U6LYTKGM6H2IXO7ZNVHYELCRKICD36ZL

//割り当て(課題)に添付するファイルをアップロード
PUT {{resourcesFolderUrl}}:/MicrosoftTeamsforEducation_QuickGuide_JA-JP.pdf:/content
Authorization: {{token}}
Content-Disposition: form-data; name="file"; filename="MicrosoftTeamsforEducation_QuickGuide_JA-JP.pdf"
Content-Type: application/pdf

< C:\Users\osamum\Documents\Job\Tech\Teams\Education\MicrosoftTeamsforEducation_QuickGuide_JA-JP.pdf



### ファイルパスを指定
//プロパティ parentReference/path

@filePath = /drives/b!aKengelSM0iBQKkgKWInObjlPupbcyZHioQtuvlMHIzGLRIfCr3MRobbRxHwNrrr/root:/Assignments/Graph API \u3067\u4f5c\u6210\u3057\u305f\u8ab2\u984c2 

//educationFileResource を作成　odata id は drive + ID 属性
POST https://graph.microsoft.com/v1.0/education/classes/{{class-id}}/assignments/{{assignment-id}}/resources
Authorization: {{token}}
Content-type: application/json

{
    "distributeForStudentWork":false,
    "resource": {
        "displayName": "article.pdf",
        "file": {
            "odataid": "https://graph.microsoft.com/v1.0/drives/b!aKengelSM0iBQKkgKWInObjlPupbcyZHioQtuvlMHIzGLRIfCr3MRobbRxHwNrrr/items/01U6LYTKDJ3AL5LDJMYNGJ5W3J7K4YRL5B"
        },
        "@odata.type": "#microsoft.graph.educationFileResource"
    }
}


### 割り当ての発行
//生徒に課題を割り当てる
POST https://graph.microsoft.com/v1.0/education/classes/{{class-id}}/assignments/{{assignment-id}}/publish
Authorization: {{token}}
Content-type: application/json